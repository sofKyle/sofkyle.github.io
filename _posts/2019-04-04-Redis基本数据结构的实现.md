---
layout: post
title: Redis基本数据结构的实现
tags: [Redis, ]

---

# 简单动态字符串（SDS - Simple Dynamic String）
也就是我们常说的Redis中的String类型，它的数据结构为：  
```C
struct sdshdr {
    int len;
    int free;
    char buf[];
}
```

**len**: 标识当前字符串的实际长度  
**free**: 标识剩余空间  
**buf[]**: 存储字符数据的char数组  

基于这种设计的SDS有如下特性：  
+ 记录了字符串长度，获取字符串长度的复杂度为O(1)  
+ 通过**预分配**策略，杜绝了缓冲区溢出  
+ 通过**预分配**和**惰性空间释放**策略减少了修改字符串时带来的内存重分配次数  
+ 二进制安全，可以保存图片、音频、视频、压缩文件等二进制数据  

