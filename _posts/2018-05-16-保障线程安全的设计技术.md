---
layout: post
title: 保障线程安全的设计技术
tags: [Java多线程, ]

---

### 无状态对象
**对象**就是操作和数据的封装。对象所包含的数据就被称为该对象的**状态**，它包括存储在实例变量或者静态变量之中的数据。相应地，实例变量、静态变量也被称为**状态变量**。

如果一个类的同一个实例被多个线程共享并不会使得这些线程存在共享状态，那么这个类及其任意一个实例就被称为**无状态对象**。

反之，如果一个类的同一个实例被多个线程共享，会使这些线程存在共享状态，那么这个类及其任意一个实例就被称为**有状态对象**。

所谓的**无状态对象**就是这样一种办法：一个线程执行无状态对象的任意一个方法来完成某个计算的时候，该计算的瞬时状态（中间结果）仅体现在局部变量或只有当前执行的线程能够访问的对象的状态上。

因此，一个线程执行无状态对象的任何方法都不会对访问该无状态对象的其他线程产生任何干扰作用。这些线程在执行该对象的任何方法的时候都无须使用同步机制。



### 不可变对象
**不可变对象**是指一经创建其状态就保持不变的对象。

一个严格意义上的不可变对象要同时满足以下所有条件：
+ 类本身使用**final**修饰：这是为了防止通过创建子类来改变其定义的行为。
+ 所有字段都是用**final**修饰：在多线程环境下保证了被修饰字段的初始化安全，即final修饰的字段在对其他线程可见时，它必定是初始化完成的。
+ 对象在初始化过程中没有逃逸：防止其他类（如该类的内部匿名类）在对象初始化过程中修改其状态。
+ 任何字段若引用了其他状态可变的对象（如集合、数组等），则这些字段必须是**private**修饰的，并且这些字段值不能对外暴露。



### 线程特有对象：ThreadLocal&lt;T&gt;




### 装饰器模式



### 并发集合

